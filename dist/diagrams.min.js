!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=c(1),f=d(e);f["default"].utils=c(2),f["default"].events=f["default"].utils.createAnEventEmitter(),f["default"].shared=c(3),f["default"].shapes=c(4),f["default"].svg=c(5),f["default"].Diagram=c(6)(),_.each(["Box","Graph","Layer"],function(a){return c(7)("./"+a+"/index")()}),window.diagrams=f["default"]},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]={},a.exports=b["default"]},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c={d3DefaultReturnFn:function(a,b,c){return a=a.split("."),function(d){var e=_.reduce(a,function(a,b){return a[b]},d);return b||c?b+e+c:e}},applySimpleTransform:function(a){a.attr("transform",function(a){return"translate("+a.x+","+a.y+")"})},positionFn:function(a,b){return b=b||0,c.d3DefaultReturnFn(a,0,b)},textFn:function(a,b,d){return b=b||"",d=d||"",c.d3DefaultReturnFn(a,b,d)},runIfReady:function(a){"complete"===document.readyState?a():window.onload=a},replaceCodeFragmentOfText:function(a,b){var c=/``([\s\S]*?)``([\s\S]*?)``/g,d=a.match(c);return a.replace(c,function(a,c,e){return b({matchStr:a,language:c,codeBlock:e,allMatches:d})})},formatTextFragment:function(a){var b=["strong","code","pre","br","span","p"],d=function e(b,c){var d=_.partial(e,b),f=["<"+c+"(.*?)>","<"+c+"$1>",c+"DIAGSA(.*?)DIAGSB"+c+"DIAGSC",c+"DIAGSA$1DIAGSB"+c+"DIAGSC"],g="</"+c+">",h=c+"ENDREPLACEDDIAGRAMS",i=[g,g,h,h],j=function(b,c){a=a.replace(new RegExp(b,"g"),c)};_.isArray(c)?_.each(c,d):_.each([f,i],function(a){"encode"===b?j(a[0],a[3]):"decode"===b&&j(a[2],a[1])})};return a=c.replaceCodeFragmentOfText(a,function(a){var b=a.matchStr,c=a.language,d=a.codeBlock,e=a.allMatches,f=b===_.last(e);return"<pre"+(f?' class="last-code-block" ':"")+"><code>"+(hljs.highlight(c,d).value+"</pre></code>")}),d("encode",b),a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),d("decode",b),a},codeBlockOfLanguageFn:function(a,b){return b=b||"",function(c,d,e){return e===!0&&(c=b+" ...\n"+c+"\n"+b+" ..."),_.isString(d)&&(c=b+" @"+d+"\n"+c),"``"+a+"``"+c+"``"}},wrapInParagraph:function(a){return"<p>"+a+"</p>"},composeWithEventEmitter:function(a){var b={},c=function(a){return"$"+a},d=function(a){({}).hasOwnProperty.call(b,a)&&(b[a].dispose(),b[a]=null)};a.prototype.emit=function(a,d){var e=c(a);b[e]=b[e]||new Rx.Subject,b[e].onNext(d)},a.prototype.listen=function(a,d){var e=c(a);return b[e]=b[e]||new Rx.Subject,b[e].subscribe(d)},a.prototype.unlisten=function(a){var b=c(a);d(b)},a.prototype.dispose=function(){for(var a in b)d(a);b={}}},createAnEventEmitter:function(){var a=function(){};return c.composeWithEventEmitter(a),new a},generateATextDescriptionStr:function(a,b){var c=b?"<br>"+b:"";return"<strong>"+a+"</strong>"+c},formatShortDescription:function(a){return a=a.replace(/<p>/g,""),a=a.replace(/<br>/g," "),a=a.replace(/<\/p>/g,". "),a=c.replaceCodeFragmentOfText(a,function(b){var c=b.matchStr,d=b.codeBlock;return c===a&&/\n/.test(c)===!1?d:" <CODE...>"})},dataFromGeneralToSpecificForATreeStructureType:function(a){var b=!1,c={},d={},e=function(){var d=void 0,e={},f=function h(f){var i=void 0,j=void 0,k=void 0;return d.indexOf(f)>-1?void(b=!0):(d.push(f),_.isUndefined(e[f.id])===!1?i=e[f.id]:(i=_.where(a.connections,{from:f.id}),e[f.id]=i),void(0===i.length?g?g.id!==f.id&&(b=!0):g=f:1===i.length?(j=i[0].to,_.isUndefined(c[j])===!1?k=c[j]:(k=_.where(a.items,{id:j})[0],c[j]=k),h(k)):b=!0))};_.each(a.items,function(a){b===!1&&(d=[],c[a.id]=a,f(a))})},f=function h(b,d){var e=void 0,f=void 0;b.id=d.id,e=d.name,d.description&&(e+=": "+d.description),b.text=e,f=_.where(a.connections,{to:d.id}),f.length>0&&(b.items=[],_.each(f,function(a){b.items.push({}),h(_.last(b.items),c[a.from])}))},g=void 0;return e(),b?(alert("The data structure is not suitable for this diagram"),[]):(f(d,g),d)},getUrlParams:function(){for(var a={},b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if("undefined"==typeof a[e[0]])a[e[0]]=decodeURIComponent(e[1]);else if("string"==typeof a[e[0]]){var f=[a[e[0]],decodeURIComponent(e[1])];a[e[0]]=f}else a[e[0]].push(decodeURIComponent(e[1]))}return a},joinWithLastDifferent:function(a,b,c){return a.slice(0,-1).join(b)+c+a[a.length-1]}};c.commasAndAndJoin=_.partial(c.joinWithLastDifferent,_,", "," and "),b["default"]=c,a.exports=b["default"]},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=arguments,d={get:function(a){return d.throwIfSharedMethodAlreadyExists(a),d[a]},set:function(a){d.throwIfSharedMethodAlreadyExists(a);for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b])},getWithStartingBreakLine:function(){return"<br>"+d.get.apply(d,c)},throwIfSharedMethodAlreadyExists:function(a){var b=void 0;if(_.isObject(a))b=Object.keys(a),_.each(b,d.throwIfSharedMethodAlreadyExists);else if(_.isString(a)&&d[e].indexOf(a)>0)throw new Error("Reserved keyword: "+a)}},e="builtInMethods";d[e]=_.keys(d).concat(e),b["default"]=d,a.exports=b["default"]},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d={hexagon:function(a){var b=a.height/2,d=a.width/2,e=a.widthPercent?(1-a.widthPercent/100)*a.width:(a.width-a.height)/2,f=a.center||[d,b],g=c(f,2),h=g[0],i=g[1];return"M"+(h-d)+","+i+("L"+(h-d+e)+","+(i+b))+("L"+(h+d-e)+","+(i+b))+("L"+(h+d)+","+i)+("L"+(h+d-e)+","+(i-b))+("L"+(h-d+e)+","+(i-b))+"Z"}};b["default"]=d,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c(1),f=d(e),g=function(a){for(var b=a.self,c=a.textLength,d=a.width,e=a.text;c>d&&e.length>0;)e=e.slice(0,-4),b.text(e+"..."),c=b.node().getComputedTextLength()},h=function(a){var b=a.filter,c=a.deviation,d=a.slope;b.append("feOffset").attr({result:"offOut","in":"SourceGraphic",dx:.5,dy:.5}),b.append("feGaussianBlur").attr({result:"blurOut","in":"offOut",stdDeviation:c}),b.append("feBlend").attr({"in":"SourceGraphic",in2:"blurOut",mode:"normal"}),b.append("feComponentTransfer").append("feFuncA").attr({type:"linear",slope:d})},i={addVerticalGradientFilter:function(a,b,c){var d=a.append("defs"),e=d.append("linearGradient").attr({id:b,x1:"0%",y1:"0%",x2:"0%",y2:"100%"});e.append("stop").attr("offset","0%").style({"stop-color":c[0],"stop-opacity":1}),e.append("stop").attr("offset","100%").style({"stop-color":c[1],"stop-opacity":1})},addFilterColor:function(a){var b=a.id,c=a.container,d=a.deviation,e=a.slope,f=a.extra,g=c.append("defs"),i=g.append("filter").attr({id:"diagrams-drop-shadow-"+b});f&&i.attr({width:"500%",height:"500%",x:"-200%",y:"-200%"}),h({filter:i,deviation:d,slope:e})},generateSvg:function(a){var b=i.getDiagramWrapperStr(),c=document.body.getBoundingClientRect();return d3.select(b).append("svg").attr({width:c.width-40,height:4e3}).style(a)},textEllipsis:function(a){return function(){var b=d3.select(this),c=b.node().getComputedTextLength(),d=b.text();g({self:b,width:a,textLength:c,text:d})}},updateHeigthOfElWithOtherEl:function(a,b,c){a.attr({height:b[0][0].getBoundingClientRect().height+(c||0)})},insertInBodyBeforeSvg:function(a){var b=i.getDiagramWrapperStr(),c=d3.select("body"),d="body"===b?"svg":b,e=c.insert(a,d);return e}};i.getDiagramWrapperStr=function(){return f["default"].diagramsWrapperSelector||"body"},i.fullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null},i.selectScreenHeightOrHeight=function(a){return f["default"].svg.fullscreenElement()?screen.height-30:a},b["default"]=i,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c(1),i=d(h),j=c(5),k=d(j),l={},m=0;i["default"].diagramsRegistry=[];var n=function(){var a=function(){function a(b){f(this,a);var c=this,d=Object.getPrototypeOf(c);c.name=b.name,c._configuration=b.configuration||{},d.configurationKeys=b.configurationKeys||{},_.each(Object.keys(b.helpers),function(a){_.isFunction(b.helpers[a])&&(b.helpers[a]=_.bind(b.helpers[a],c))}),_.merge(c._configuration,l),_.each(Object.keys(c._configuration),function(a){c.configCheckingLocalStorage(a,c._configuration[a])}),_.defaults(d,b.helpers),c.register()}return g(a,null,[{key:"convertDiagram",value:function(b,c){var d=a.getRegistryItemWithCreationId(b),e=d.data.slice(1),f=void 0,g=void 0;f=d.diagram.dataFromSpecificToGeneral.apply({},e),g=i["default"][c].dataFromGeneralToSpecific.apply({},[f]),i["default"].events.emit("diagram-to-transform",d.diagram),a.removePreviousDiagrams(),i["default"][c].apply(d.diagram,[g])}},{key:"removePreviousDiagrams",value:function(){d3.selectAll("input.diagrams-diagram-button").remove(),d3.select("svg").remove()}},{key:"addDivBeforeSvg",value:function(){var a=k["default"].insertInBodyBeforeSvg("div");return a.appendButtonToDiv=function(b,c,d){a.append("input").attr({type:"button","class":b+" diagrams-diagram-button btn btn-default",onclick:d,value:c})},a}},{key:"getRegistryItemWithCreationId",value:function(a){var b=_.where(i["default"].diagramsRegistry,{id:a});return 1===b.length?b[0]:null}},{key:"getDataWithCreationId",value:function(b){var c=a.getRegistryItemWithCreationId(b);return c?c.data:null}}]),g(a,[{key:"reRender",value:function(){return null}},{key:"addMouseListenersToEl",value:function(a,b,c){var d=this,e=function(b,e){e=e||b,a.on(b,function(){d.emit(e,f),c&&c[b]&&c[b](f)})},f={el:a,data:b};e("mouseleave"),e("mouseenter"),e("click","itemclick")}},{key:"removePreviousAndCreate",value:function(){var b=this;a.removePreviousDiagrams(),b.addConversionButtons(),b.create.apply(b,arguments)}},{key:"config",value:function(a,b){var c=arguments.length,d=typeof a,e=void 0;if(0===c)return this._configuration;if(1===c){if(_.isFunction(d))e=a();else if(_.isString(a))e=a;else if(_.isObject(a)){for(var f in a)a.hasOwnProperty(f)&&this.config(f,a[f]);return a}return this._configuration[e]}return 2===c?(this._configuration[a]=b,_.isObject(b)?this.setToLocalStorage(a,b.value):this.setToLocalStorage(a,b),this.emit("configuration-changed",{key:a,value:b}),b):void 0}},{key:"configCheckingLocalStorage",value:function(a,b){var c=this,d=c.getFromLocalStorage(a,b);c.config(a,d)}},{key:"generateLocalStorageKeyPreffix",value:function(a){return"diagramsjs-"+a}},{key:"getFromLocalStorage",value:function(a,b){var c=this,d=function(b){var d=localStorage.getItem(c.generateLocalStorageKeyPreffix(a))||b;return"false"===d?d=!1:"true"===d&&(d=!0),d},e=b;return localStorage&&localStorage.getItem&&(_.isObject(e)?(e.value=d(e.value),e.type&&(e.value=e.type(e.value))):e=d(e)),e}},{key:"setToLocalStorage",value:function(a,b){var c=this;return localStorage&&localStorage.setItem?localStorage.setItem(c.generateLocalStorageKeyPreffix(a),b):void 0}},{key:"generateEmptyRelationships",value:function(a){a.relationships={},a.relationships.dependants=[],a.relationships.dependencies=[]}},{key:"addDependantRelationship",value:function(a,b,c){a.relationships.dependants.push(this.generateRelationship(b,c))}},{key:"addSelfRelationship",value:function(a,b,c){a.relationships.self=this.generateRelationship(b,c)}},{key:"addDependencyRelationship",value:function(a,b,c){a.relationships.dependencies.push(this.generateRelationship(b,c))}},{key:"generateRelationship",value:function(a,b){return{el:a,data:b}}},{key:"getAllRelatedItemsOfItem",value:function(a,b){var c=this,d=[],e=function g(a,c){_.each(a.relationships[b],function(b){100>c&&d.indexOf(b)<0&&b.data!==a&&(d.push(b),g(b.data,c+1))})},f=void 0;return b?(e(a,0),d):(f={},_.each(["dependants","dependencies"],function(b){f[b]=c.getAllRelatedItemsOfItem(a,b)}),f)}},{key:"markRelatedItems",value:function(a,b){var c=void 0,d=this,f=function(b){c.push(d.getAllRelatedItemsOfItem.apply(d,e([a].concat(b))))};b=b||{},d.markRelatedFn&&a.relationships&&(c=[],b.filter?f([b.filter]):_.each([["dependants"],["dependencies"]],f),_.each(c,function(a){_.each(a,d.markRelatedFn)}),d.markRelatedFn(a.relationships.self))}},{key:"register",value:function(){var a=this;i["default"].diagramTypes=i["default"].diagramTypes||[],i["default"].diagramTypes.push(a.name),i["default"][a.name]=function(){var b=Array.prototype.slice.call(arguments);i["default"].utils.runIfReady(function(){m++,i["default"].diagramsRegistry.push({diagram:a,data:b,id:m}),a.diagramId=m,a.addConversionButtons(),b.unshift(m),a.create.apply(a,e(b)),i["default"].events.emit("diagram-created",a)})},_.defaults(i["default"][a.name],Object.getPrototypeOf(a))}},{key:"addConversionButtons",value:function(){var b=this,c=a.addDivBeforeSvg(),d=void 0;_.each(i["default"].diagramTypes,function(a){a!==b.name&&(d="diagrams.Diagram.convertDiagram("+b.diagramId+", '"+a+"')",c.appendButtonToDiv("diagrams-box-conversion-button","To "+a+" diagram",d))})}}]),a}();return i["default"].utils.composeWithEventEmitter(a),a};b["default"]=n,a.exports=b["default"]},function(a,b,c){function d(a){return c(e(a))}function e(a){return f[a]||function(){throw new Error("Cannot find module '"+a+"'.")}()}var f={"./Box/index":8,"./Graph/index":9,"./Layer/index":11};d.keys=function(){return Object.keys(f)},d.resolve=e,a.exports=d,d.id=7},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(b,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;return void 0===i?void 0:i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return void 0;a=j,b=f,c=g,d=!0,h=j=void 0}},i=c(1),j=d(i);b["default"]=function(){var a={filterByString:_.debounce(function(b,c){var d=function(a){return function(b){b.hidden=a}},e=d(!1);a.traverseBodyDataAndRefresh(c,null,function(a,c){var f=_.any(c,function(a){return a.hidden!==!0});b.showChildren===!1||f===!1?new RegExp(b.str,"i").test(a.text)===!1?d(!0)(a):(_.each(c,e),e(a)):e(a)})},500),generateDefinitionWithSharedGet:function(){for(var a=arguments.length,b=Array(a),d=0;a>d;d++)b[d]=arguments[d];var e=b[0],f=void 0,g=void 0;return g=arguments.length>1?b[1]:"",f=g+e.split("(")[0],c.generateDefinition(e,j["default"].shared.get(f))},addButtons:function(a){var b=j["default"].Diagram.addDivBeforeSvg();b.appendButtonToDiv("diagrams-box-collapse-all-button","Collapse all","diagrams.box.collapseAll("+a+")"),b.appendButtonToDiv("diagrams-box-expand-all-button","Expand all","diagrams.box.expandAll("+a+")")},expandOrCollapseAll:function(b,c){a.traverseBodyDataAndRefresh(b,{withCollapsedItems:!0},function(b){b.hasOwnProperty("collapsed")&&a[c+"Item"](b)})},traverseBodyDataAndRefresh:function(b,c,d){var e=j["default"].Diagram.getDataWithCreationId(b)[1],f=e.body,g=function h(a,b){_.each(a,function(a){d&&d(a,b),a.items&&h(a.items,b.concat(a)),c.withCollapsedItems&&a.collapsedItems&&h(a.collapsedItems,b.concat(a))})};c=c||{},c.withCollapsedItems=c.withCollapsedItems||!1,g(f,[]),a.addBodyItemsAndUpdateHeights()},collapseAll:function(b){a.expandOrCollapseAll(b,"collapse")},expandAll:function(b){a.expandOrCollapseAll(b,"expand")},convertToGraph:function(a){console.log("origConf",a)},convertToLayer:function(a){var b=function e(a){_.each(a,function(b,c){_.isString(b)&&(b=a[c]={text:b}),b.description&&(b.text+=": "+b.description),b.items?e(b.items):b.items=[]})},c=function(){var a=d3.select("svg");d3.selectAll("input.diagrams-diagram-button").remove(),a.remove(),j["default"].layer(d)},d=[];d.push({text:a.name,items:a.body}),b(d[0].items),c()},collapseItem:function(a){a.items.length>0&&(a.collapsedItems=a.items,a.collapsed=!0,a.items=[])},expandItem:function(a){a.collapsedItems&&(a.items=a.collapsedItems,delete a.collapsedItems,a.collapsed=!1)},parseItemGenerationOptions:function(a){var b=void 0;return _.isString(a)?(a=a.split(" "),b={},_.each(a,function(a){var c=a.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()});b[c]=!0})):b=a,b},generateItem:function(b){var c=b.text,d=b.description,e=b.items,f=b.options,g={isLink:!1,notCompleted:!1};return f=f||{},f=a.parseItemGenerationOptions(f),{text:c,description:d||null,options:_.defaults(f,g),items:e||[]}},generateContainer:function(){var b=arguments[0],c=arguments[1],d=arguments[2],e=arguments[3]||null;return _.isArray(c)&&(e=d,d=c,c=null),a.generateItem({text:b,description:c,items:d,options:e})},generateLink:function(b,c){return a.generateItem({text:b,description:c,items:null,options:{isLink:!0}})},generateDefinition:function(b,c){return a.generateItem({text:b,description:c})},dataFromSpecificToGeneral:function(a){var b=-1,c=[],d=[],e=function f(a,e){_.each(a,function(a){var g={name:a.text,description:a.description,graphsData:{box:{options:a.options}},id:++b};c.push(g),e?d.push({from:g.id,to:e.id}):d.push({from:g.id,to:0}),a.items&&a.items.length>0&&f(a.items,g)})};return c.push({name:a.name,id:++b}),e(a.body),{items:c,connections:d}},dataFromGeneralToSpecific:function(a){var b=j["default"].utils.dataFromGeneralToSpecificForATreeStructureType(a);return b.name=b.text,b.body=b.items,delete b.items,delete b.text,b}},b=0,c=function(c){function d(){e(this,d),h(Object.getPrototypeOf(d.prototype),"constructor",this).apply(this,arguments)}return f(d,c),g(d,[{key:"create",value:function(c,d,e){var f=this,g=this,h=j["default"].svg.generateSvg(),i=h.attr("width")-40,k=50,l=h.append("g").attr({transform:"translate(20, 20)","class":"box-diagram"}),m=l.append("g"),n=30,o=35,p=j["default"].utils.getUrlParams(),q=function(b,c){(c.items.length>0||c.collapsedItems)&&!function(){var d=b.select("text"),e=d.attr("y"),f=d.attr("x"),g=b.append("g").attr({"class":"collapsible-trigger"}),h=function(){a.collapseItem(c),a.addBodyItemsAndUpdateHeights()},i=function(){a.expandItem(c),a.addBodyItemsAndUpdateHeights()},j=g.append("text").attr({y:Number(e)+5,x:Number(f)-20}),k=function(){j.text("-").attr("class","minus"),g.on("click",h)},l=function(){j.text("+").attr({"class":"plus",y:e}),g.on("click",i)},m=void 0;t+=1,m="clippath-"+t,g.append("clipPath").attr("id",m).append("rect").attr({height:15,width:20,y:e-17,x:f-20}),j.attr("clip-path","url(#"+m+")"),_.isUndefined(c.collapsed)?(c.collapsed=!1,k()):c.collapsed===!0?l():c.collapsed===!1&&k()}()},r=function x(c,e,f){var i=void 0,k=void 0,l=void 0,m=void 0,p=void 0,r=void 0;c=c||d.body,e=e||u,f=f||1,c===d.body&&(v=1),_.each(c,function(d,s){if(d.hidden!==!0){var t="diagrams-box-text-"+b++;_.isString(d)&&(d=a.generateItem({text:d}),c[s]=d),d.items=d.items||[],d.items.length>0?(i=e.append("g"),p=j["default"].utils.formatShortDescription(d.text),d.items&&d.items.length>0&&(p+=":"),d.description?(d.fullText=j["default"].utils.generateATextDescriptionStr(p,d.description),p+=" (...)"):d.fullText=d.text,k=i.append("text").text(p).attr({x:o*f,y:n*++v,id:t}),x(d.items,i,f+1)):d.options&&d.options.isLink===!0?(i=e.append("svg:a").attr("xlink:href",d.description),k=i.append("text").text(j["default"].utils.formatShortDescription(d.text)).attr({id:t,x:o*f,y:n*++v,fill:"#3962B8"}),d.fullText=d.text+" ("+d.description+")"):(i=e.append("g").attr({id:t}),k=i.append("text").text(j["default"].utils.formatShortDescription(d.text)).attr({x:o*f,y:n*++v,"class":"diagrams-box-definition-text"}),d.description&&(l=k[0][0].getBoundingClientRect().width,m=h[0][0].getBoundingClientRect().width-l-o*f-30,i.append("text").text("- "+j["default"].utils.formatShortDescription(d.description)).attr({x:o*f+l+5,y:n*v-1}).each(j["default"].svg.textEllipsis(m))),d.fullText=j["default"].utils.generateATextDescriptionStr(d.text,d.description)),q(i,d),d.textG=i,d.textEl=k,d.options.notCompleted===!0&&(d.textG.attr("class",""+(d.textG.attr("class")||"")+" diagrams-box-not-completed-block"),r=d.textEl.text(),d.textEl.text(""),d.textEl.append("tspan").text(r+" "),d.textEl.append("tspan").text("[NOT COMPLETED]").attr("class","diagrams-box-not-completed-tag")),g.addMouseListenersToEl(k,d)}})},s=function(a){var b=null,c=function g(c){_.each(c,function(c){_.isNull(b)&&(_.isString(c.text)&&c.text.indexOf(a)>-1?b=c:c.items&&g(c.items))})},e=void 0,f=void 0;c(d.body),b&&(e=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),f=b.textG[0][0].getBoundingClientRect().top,_.defer(function(){window.scrollTo(0,f+e)})),console.log("targetFound",b)},t=void 0,u=void 0,v=void 0,w=void 0;e=e||{},a.addBodyItemsAndUpdateHeights=_.bind(function(){var a=f,b=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0);h.attr("height",10),u&&u.remove(),u=l.append("g").attr({transform:"translate(0, "+k+")"}),w=u.append("rect").attr({width:i,stroke:"#000",fill:"#fff"}).style({filter:"url(#diagrams-drop-shadow-box)"}),t=0,r(),a.setRelationships(d.body),j["default"].svg.updateHeigthOfElWithOtherEl(h,l,50),j["default"].svg.updateHeigthOfElWithOtherEl(w,l,25-k),window.scrollTo(0,b),a.emit("items-rendered")},this),j["default"].svg.addFilterColor({id:"box",container:h,deviation:3,slope:4}),m.append("rect").attr({height:k,width:i,stroke:"#000",fill:"#fff"}).style({filter:"url(#diagrams-drop-shadow-box)"}),m.append("text").attr({x:i/2,y:30}).text(d.name).style({"font-weight":"bold","text-anchor":"middle"}),d3.select(document.body).style("opacity",0),a.addBodyItemsAndUpdateHeights(),e.allCollapsed===!0&&a.collapseAll(c),a.addButtons(c),d3.select(document.body).style("opacity",1),p.target&&s(p.target)}},{key:"setRelationships",value:function(a,b){var c=this;_.each(a,function(a){c.generateEmptyRelationships(a),b&&(c.addDependantRelationship(b,a.textG,a),c.addDependencyRelationship(a,b.textG,b)),a.items&&a.items.length>0&&c.setRelationships(a.items,a)})}}]),d}(j["default"].Diagram);new c({name:"box",helpers:a})},a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(b,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;return void 0===i?void 0:i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return void 0;a=j,b=f,c=g,d=!0,h=j=void 0}},j=c(1),k=d(j),l=c(10),m=d(l);b["default"]=function(){var a,b="Show connections selectively",c="dia graph zoom",d="Drag nodes on click (may make links difficult)",j="All arrows are curved",l={"private":!0,type:Number,value:1},n=k["default"].utils.positionFn,o=k["default"].utils.textFn,p=function(a){function e(){f(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return g(e,a),h(e,[{key:"create",value:function(a,e,f){var g=this,h=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=k["default"].svg.generateSvg(),p=i.append("g"),q=i.attr("width"),r=g.config(d),s=g.config(j);m["default"].resetLinksNumberMap();var t=void 0,u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0,A=void 0,B=void 0,C=void 0,D=void 0,E=k["default"].svg.selectScreenHeightOrHeight(h-250),F=function(){var a=function(a){v.select("path."+a).attr("d",function(a){var b=m["default"].getLinksNumberMapItemWithLink(a),c=a.data.linkIndex,d=a.target.x-a.source.x,e=a.target.y-a.source.y,f=Math.sqrt(d*d+e*e)*(s?3.5:1)*(c+(s?1:0)/(3*b));return"M"+a.source.x+","+a.source.y+"A"+(f+","+f+" 0 0,1 ")+(a.target.x+","+a.target.y)})};_.each(["link-path","link-path-outer"],a),x.each(function(a){"circle"===a.shape?x.select("circle").attr("cx",n("x")).attr("cy",n("y")):("triangle"===a.shape?B=x.select("path.triangle"):"square"===a.shape&&(B=x.select("path.square")),k["default"].utils.applySimpleTransform(B))}),x.select("text").attr("x",n("x")).attr("y",n("y",-20))},G=function(){var a=_.reduce(e,function(a,b){var c=b.id||0;return a>c?a:c},0),b={},c={},d=d3.scale.category20(),h=function(a,d){a.connections.length>0&&_.each(a.connections,function(a){_.each(a.nodesIds,function(e){n=b[e],n&&(f.hideNodesWithoutLinks&&(c[n.index]=!0,c[d]=!0),o={},"out"===a.direction?(o.source=d,o.target=n.index):(o.source=n.index,o.target=d),o.data=a,o.color=D.nodes[o.source].color,m["default"].updateLinksNumberMapWithLink(o),o.data.linkIndex=m["default"].getLinksNumberMapItemWithLink(o)-1,o.data.text&&(o.data.fullText=o.data.text),D.links.push(o))})})},j=void 0,k=void 0,l=void 0,n=void 0,o=void 0;D={links:[],nodes:[]},C=[],_.each(e,function(c,e){j=_.isUndefined(c.id)?a++:c.id,k=d(e),l=c.options||{},D.nodes.push({bold:l.bold||!1,color:k,connections:c.connections||[],description:c.description||null,id:j,linkToUrl:l.linkToUrl||null,name:c.name,shape:l.shape||"circle"}),b[j]={index:e},b[j].color=k,C.push({color:k,id:j})}),g.config(f),f.info&&m["default"].addDiagramInfo(g,i,f.info),_.each(D.nodes,h),f.hideNodesWithoutLinks===!0&&_.each(D.nodes,function(a,b){c[b]!==!0&&(a.hidden=!0)})},H=function(a,b){b=b||1,p.attr("transform","translate("+a+")scale("+b+")"),l.value=b,g.config(c,l)},I=function(){d3.event.sourceEvent.stopPropagation(),d3.select(this).classed("dragging",!0),t.start()},J=function(a){d3.select(this).attr("cx",a.x=d3.event.x).attr("cy",a.y=d3.event.y)},K=function(){d3.select(this).classed("dragging",!1)},L=function(){_.each(D.nodes,g.generateEmptyRelationships,g),_.each(D.nodes,function(a){g.addSelfRelationship(a,a.shapeEl,a)}),_.each(D.links,function(a){g.addDependencyRelationship(a.source,a.target.shapeEl,a.target),g.addDependantRelationship(a.target,a.source.shapeEl,a.source)})},M=function(){return p.selectAll(".link")},N=function(){return M().filter(function(a){return a.data.hasOwnProperty("shyIsHiding")})},O=function(a,c){var d=void 0;g.config(b)&&(a===!1?c.data.shyIsHiding=a:a===!0&&(d=N(),d.each(function(a){a.data.shyIsHiding=!0})),c.data.shyIsHidingChanged=!0)},P=function(a,b){var c="show"===a,d="hide"===a,e=b.data,f=N(),g=M().filter(function(a){return a.source.id===e.id||a.target.id===e.id}),h=function(a,b){a.classed("shy-link-hidden",!b),a.classed("shy-link-showed",b)},i=function(a){h(a,!1),a.each(function(a){delete a.data.shyIsHiding})},j=function m(){setTimeout(function(){k=!0,l=!0,g.each(function(a){k=k&&a.data.shyIsHiding,a.data.shyIsHidingChanged&&(l=!1,delete a.data.shyIsHidingChanged)}),k&&l?i(g):m()},500)},k=void 0,l=void 0;0===f[0].length?c?h(g,!0):d&&(g.each(function(a){a.data.shyIsHiding=!0}),j()):c?f.each(function(a,b){0===b&&(a.data.shyIsHiding=!1)}):d&&O(!0,f.data()[0])},Q=_.partial(m["default"].setReRender,g,a,e,_);g.markRelatedFn=function(a){a.el.style("stroke-width","20px")},g.unmarkAllItems=function(){_.each(D.nodes,function(a){a.shapeEl.style("stroke-width","1px")})},f=f||{},G(),i.attr({height:E,"class":"graph-diagram"}),y=d3.behavior.zoom().scaleExtent([.1,10]).on("zoom",function(){H(d3.event.translate,d3.event.scale)}),i.call(y),y.translate([100,100]).scale(g.config(c).value),H(y.translate(),y.scale()),t=d3.layout.force().size([q,E]).charge(f.charge||-1e4).linkDistance(f.linkDistance||140).on("tick",F),u=d3.behavior.drag().origin(function(a){return a}).on("dragstart",I).on("drag",J).on("dragend",K),t.nodes(D.nodes).links(D.links).start(),p.append("svg:defs").selectAll("marker").data(C).enter().append("svg:marker").attr({"class":"arrow-head",fill:o("color"),id:o("id","arrow-head-"),markerHeight:8,markerWidth:8,orient:"auto",refX:19,refY:s?-1.5:0,viewBox:"0 -5 10 10"}).append("svg:path").attr("d","M0,-5L10,0L0,5"),v=p.selectAll(".link").data(D.links).enter().append("g").attr("class",function(){var a="link";return g.config(b)&&(a+=" shy-link shy-link-hidden"),a}),v.append("svg:path").attr({"class":"link-path","marker-end":function(a){return"url(#arrow-head-"+a.source.id+")"}}).style({stroke:o("color"),"stroke-dasharray":function(a){return"plain"===a.data.line?null:"dotted"===a.data.line?"5,5":void 0}}),w=v.append("g"),w.append("svg:path").attr("class","link-path-outer"),w.each(function(a){g.addMouseListenersToEl(d3.select(this),a.data,{mouseenter:function(a){O(!1,a)},mouseleave:function(a){O(!0,a)}})}),x=p.selectAll(".node").data(D.nodes).enter().append("g").attr({"class":function(a){var b="node";return a.hidden===!0&&(b+=" node-hidden"),b},id:o("id","node-")}),x.each(function(a){var c="";z=d3.select(this),a.fullText=k["default"].utils.generateATextDescriptionStr(a.name,a.description),"circle"===a.shape?B=z.append("circle").attr({r:12,fill:o("color")}):(A=d3.svg.symbol().size(750),B=z.append("path"),"triangle"===a.shape?(A=A.type("triangle-up"),c+=" triangle"):"square"===a.shape&&(A=A.type("square"),c+=" square"),B=B.attr({d:A,fill:o("color")}),k["default"].utils.applySimpleTransform(B)),r===!0&&B.call(u),c+=a.bold===!0?" bold":" thin",B.attr("class",c),a.shapeEl=B,g.addMouseListenersToEl(B,a,{mouseenter:function(a){g.config(b)&&P("show",a)},mouseleave:function(a){g.config(b)&&P("hide",a)},click:function(a){a.data.linkToUrl&&window.open(a.data.linkToUrl)}})}),x.append("text").text(o("name")),L(),Q(f),g.listen("configuration-changed",function(c){(c.key===b||c.key===d)&&(Q(c),g.removePreviousAndCreate(a,e,c))})}}]),e}(k["default"].Diagram);new p({name:"graph",helpers:m["default"],configurationKeys:{SHY_CONNECTIONS:b},configuration:(a={info:null},e(a,b,!0),e(a,c,l),e(a,d,!1),e(a,j,!1),a)})},a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}Object.defineProperty(b,"__esModule",{value:!0});var f=c(1),g=d(f),h=void 0,i={resetLinksNumberMap:function(){
h={}},generateConnectionWithText:function(a,b){return _.isArray(a)&&_.isArray(a[0])?_.map(a,function(a){return i.generateConnectionWithText.apply({},a)}):(_.isString(a)?a=a.split(" ").map(Number):_.isNumber(a)&&(a=[a]),g["default"].graph.mergeWithDefaultConnection({nodesIds:a,text:b}))},connectionFnFactory:function(a,b,c){var d=arguments;return function(){var e=a.apply(void 0,d),f=function(a){return a[b]=c,e};return _.isArray(e)?_.map(e,f):f(e)}},generateNodeOptions:function(a){var b={},c=void 0;return _.isString(a)?i.generateNodeOptions(a.split(" ")):_.isArray(a)?(_.each(a,function(a){"s-"===a.substr(0,2)?(c=a.substr(2,a.length-2),b.shape="t"===c?"triangle":"s"===c?"square":"circle"):"b"===a?b.bold=!0:"l~"===a.substr(0,2)&&(b.linkToUrl=a.substr(2,a.length-2))}),b):void 0},mergeWithDefaultConnection:function(a){var b={direction:"out",symbol:"arrow",line:"plain"};return _.defaults(a,b)},generateNodeWithTargetLink:function(a,b){var c=arguments;return function(){var d=Array.prototype.slice.call(c);return _.isUndefined(d[3])?d[3]="":d[3]+=" ",d[3]+="l~"+a+"?target="+encodeURIComponent(b),i.generateNode.apply({},d)}},generateNodeWithTextAsTargetLink:function(a){var b=arguments;return function(){return g["default"].graph.generateNodeWithTargetLink(a,b[0]).apply({},b)}},generatePrivateNode:function(){var a=Array.prototype.slice.call(arguments);return a[2]+="<br><strong>PRIVATE</strong>",a[3]="s-t",i.generateNode.apply(i,e(a))},generateNode:function(){var a={name:arguments[0]},b=function(b){a.connections.push(i.mergeWithDefaultConnection({nodesIds:[b]}))},c=function e(b){_.isArray(b)?_.each(b,e):_.isNumber(b)?e({nodesIds:[b]}):_.isObject(b)&&(i.mergeWithDefaultConnection(b),a.connections.push(b))},d=void 0;return arguments.length>1&&(d=arguments[1],a.connections=[],_.isString(d)?(d=d.split(" ").map(Number),d.length>0&&(a.id=d[0]),d.length>1&&_.each(d,function(a,b){b>0&&c(a)})):_.isArray(d)?(a.id=d[0],d=d.slice(1),_.each(d,function(a){_.isNumber(a)?b(a):c(a)})):_.isNumber(d)&&(a.id=d),arguments.length>2&&(a.description=arguments[2]),arguments.length>3&&(a.options=i.generateNodeOptions(arguments[3]))),a},generateNodeWithSharedGet:function(){var a=arguments[0],b=void 0,c=void 0,d=void 0;return c=arguments.length>2?arguments[2]:"",b=c+a.split("(")[0],d=arguments.length>3?arguments[3]:null,i.generateNode(a,arguments[1],g["default"].shared.get(b),d)},generateFnNodeWithSharedGetAndBoldIfFile:function(a){var b=arguments;return function(){var c="",d="";return b[0].split("@")[0]===a&&(c="b"),b.length>2&&(d=b[2]),b.length>3&&(c=b[3]+" "+c),i.generateNodeWithSharedGet(b[0],b[1],d,c)}},dataFromGeneralToSpecific:function(a){var b=[],c={},d=void 0;return _.each(a.items,function(a,d){b.push({name:a.name,id:a.id,description:a.description}),c[a.id]=d}),_.each(a.connections,function(a){d=b[c[a.to]],d.connections=d.connections||[],d.connections.push({direction:"in",nodesIds:[a.from]})}),b},dataFromSpecificToGeneral:function(a){var b=[],c=[],d=function(a,b){_.each(b.nodesIds,function(d){e={},"out"===b.direction?(e.from=a.id,e.to=d):"in"===b.direction&&(e.from=d,e.to=a.id),c.push(e)})},e=void 0;return _.each(a,function(a){b.push({id:a.id,name:a.name,description:a.description}),_.each(a.connections,function(b){return d(a,b)})}),{items:b,connections:c}},doWithMinIdAndMaxIdOfLinkNodes:function(a,b){var c=function(a){return _.isNumber(a)?a:a.index},d=[c(a.source),c(a.target)],e=_.min(d),f=_.max(d);return b(e,f)},updateLinksNumberMapWithLink:function(a){i.doWithMinIdAndMaxIdOfLinkNodes(a,function(a,b){_.isUndefined(h[a])&&(h[a]={}),_.isUndefined(h[a][b])?h[a][b]=1:h[a][b]+=1})},getLinksNumberMapItemWithLink:function(a){return i.doWithMinIdAndMaxIdOfLinkNodes(a,function(a,b){return h[a][b]})},addDiagramInfo:function(a,b,c){_.isString(c)&&(c=[c]);var d=2===c.length,e=b[0][0].getBoundingClientRect().width,f=c[0]+(d?" (...)":""),h=b.append("g").attr({transform:"translate(10, 50)","class":"graph-info"}).append("text").text(f).each(g["default"].svg.textEllipsis(e));d&&a.addMouseListenersToEl(h,{el:h,fullText:g["default"].utils.generateATextDescriptionStr(c[0],c[1])})},setReRender:function(a,b,c){a.reRender=function(d){a.unlisten("configuration-changed"),a.reRender=null,a.removePreviousAndCreate(b,c,d)}}};i.resetLinksNumberMap(),b["default"]=i,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(b,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;return void 0===i?void 0:i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return void 0;a=j,b=f,c=g,d=!0,h=j=void 0}},i=c(1),j=d(i),k=c(12),l=d(k);b["default"]=function(){var a=0,b=void 0,c=j["default"].utils.textFn;new(b=function(b){function d(){e(this,d),h(Object.getPrototypeOf(d.prototype),"constructor",this).apply(this,arguments)}return f(d,b),g(d,[{key:"create",value:function(b,d){var e=this,f=l["default"].config,g=["#ECD078","#D95B43","#C02942","#78E4B7","#53777A","#00A8C6","#AEE239","#FAAE8A"],h=function r(a){_.each(a,function(a){a.hasOwnProperty("items")===!1?a.items=[]:r(a.items)})},i=function(a,b){var c=function(a){return{x:(a.x+a.width/2)*f.widthSize+f.depthWidthFactor*a.depth,y:a.y*f.heightSize+f.depthHeightFactor*a.depth}},d=function(a){return{x:(a.x+a.width/2)*f.widthSize+f.depthWidthFactor*a.depth,y:(a.y+a.height)*f.heightSize-f.depthHeightFactor*a.depth}},e=function(a){return{x:a.x*f.widthSize+f.depthWidthFactor*a.depth,y:(a.y+a.height/2)*f.heightSize+f.depthHeightFactor*a.depth}},g=function(a){return{x:(a.x+a.width)*f.widthSize-f.depthWidthFactor*a.depth,y:(a.y+a.height/2)*f.heightSize+f.depthHeightFactor*a.depth}},h=function(a){return{top:c(a),bottom:d(a),left:e(a),right:g(a)}},i={val:1/0},j=function(a){var b=a.posA,c=a.posB,d=a.sideA,e=a.sideB;if("bottom"!==d&&"left"!==d&&"top"!==d||"right"!==e){if("bottom"!==d&&"right"!==d&&"top"!==d||"left"!==e){if("bottom"!==d&&"right"!==d&&"left"!==d||"top"!==e){if(("left"===d||"right"===d||"top"===d)&&"bottom"===e&&b.y<c.y)return!1}else if(b.y>c.y)return!1}else if(b.x>c.x)return!1}else if(b.x<c.x)return!1;return!0},k=function(a,b){var c=function(a){return Math.pow(a,2)},d=Math.sqrt(c(a.x-b.x)+c(a.y-b.y));return d<i.val?(i.val=d,i.from=a,i.to=b,!0):!1},l=function(a){_.each(["top","bottom","left","right"],function(b){a(b)})},m=function(a,b){var c=!1;return _.each([[a,b],[b,a]],function(a){"top"===a[0]&&"bottom"===a[1]?c=!0:"left"===a[0]&&"right"===a[1]&&(c=!0)}),c},n=function(b){l(function(c){l(function(d){_.isUndefined(o.alreadyConnections)&&(o.alreadyConnections=[]),c!==d&&a.alreadyConnections.indexOf(c)<0&&o.alreadyConnections.indexOf(d)<0&&(b===!1&&m(c,d)===!1||m(c,d))&&j({posA:p[c],posB:q[d],sideA:c,sideB:d})&&(r=k(p[c],q[d]),r===!0&&(i.sideA=c,i.sideB=d))})})},o=b.layer,p=h(a),q=h(o),r=void 0;return n(!0),r!==!0&&n(!1),a.alreadyConnections.push(i.sideA),o.alreadyConnections.push(i.sideB),i},k=function(a){var b=a.layer.container,d=a.layer.containerData,e=void 0,f=void 0,h=void 0,j=void 0,k=void 0;_.each(a.connectedTo,function(l){h=i(a.layer,l),j=d3.svg.line().x(c("x")).y(c("y")),f=a.layer.id+"-"+l.layer.id,e=b.append("g").attr("id",f),h.from&&h.to&&(k=e.append("path").attr("d",j([h.from,h.to])).style({stroke:"#000",fill:"none"}),"dashed"===l.type&&k.style("stroke-dasharray","5, 5"),e.append("circle").attr({cx:h.to.x,cy:h.to.y,r:5,fill:g[a.layer.depth-1]}).style({stroke:"#000"}),d.connections=d.connections||[],d.connections.push({el:e,id:f}))})},m=function s(a){a=a||d,_.chain(a).filter(function(a){return a.hasOwnProperty("connectedTo")}).map(function(b){var c=[],d=void 0,e=void 0,f=void 0;return _.each(b.connectedTo,function(b){e=_.isObject(b)?b.id:b,f=_.isObject(b)&&b.type?b.type:"standard",d=_.where(a,{id:e})[0],c.push({layer:d,type:f})}),{layer:b,connectedTo:c}}).each(function(a){k(a)}).value(),_.chain(a).filter(function(a){return a.items.length>0}).each(function(a){s(a.items)}).value()},n=function(){var a=function(a){return a.y+a.height},b=_.max(d,a),c=a(b),e=c*f.heightSize+20;q.attr("height",e)},o=function(){var a=document.body.getBoundingClientRect().width;l["default"].maxUnityWidth=Math.floor(a/f.widthSize)},p=function t(b,c,h){var i=f.widthSize,k=f.heightSize,m=void 0,n=void 0,o=void 0,p=void 0;b=b||d,c=c||q,_.each(b,function(b,d){var q="diagrams-layer-g-"+a++,r=void 0;m=c.append("g").attr({transform:"translate("+b.x*i+", "+b.y*k+")","class":"layer-node",id:q}),b.layerG=m,b.container=c,b.containerData=h,o=l["default"].getFinalLayerDimensions(b),n=m.append("g"),b.conditional===!0?n.append("path").attr({d:j["default"].shapes.hexagon({height:o.height,width:o.width,widthPercent:97+Math.abs(3-b.depth)}),transform:o.transform,fill:o.fill,stroke:"#f00"}):n.append("rect").attr({width:o.width,transform:o.transform,height:o.height,fill:o.fill}).style({filter:"url(#diagrams-drop-shadow-layer)"}),p=n.append("text").attr({transform:o.transform,x:b.depth,y:b.height*k-3*b.depth-10}).text(function(){return j["default"].utils.formatShortDescription(b.text)}),b.fullText=b.text,e.addMouseListenersToEl(n,b),p.each(j["default"].svg.textEllipsis(b.width*i-f.depthWidthFactor*b.depth*2)),o.numberTransform&&(r=n.append("g").attr({"class":"number",transform:o.numberTransform}),r.append("circle").attr({r:10,cx:4,cy:-4,fill:g[b.depth-1],"stroke-width":2,stroke:"#000",filter:"none"}),r.append("text").text(d+1).attr("fill","#000")),b.items.length>0&&t(b.items,m,b)})},q=j["default"].svg.generateSvg({margin:"20px 0 0 20px"});e.markRelatedFn=function(a){a.data.origFill=a.data.origFill||a.el.select("rect").style("fill"),a.el.select("rect").style({fill:"rgb(254, 255, 209)"})},e.unmarkAllItems=function(){var a=function b(a){_.each(a,function(a){a.layerG.style({"stroke-width":"1px"}),a.origFill&&a.layerG.select("rect").style("fill",a.origFill),a.items&&b(a.items)})};a(d)},_.each(g,function(a,b){j["default"].svg.addVerticalGradientFilter(q,"color-"+b,["#fff",a])}),q.attr("class","layers-diagram"),_.isArray(d)===!1&&(d=[d]),j["default"].svg.addFilterColor({id:"layer",container:q,deviation:3,slope:2}),h(d),o(),l["default"].generateLayersData(d),p(),m(),n(),e.generateRelationships(d)}},{key:"generateRelationships",value:function(a,b){var c=this;_.each(a,function(a){c.generateEmptyRelationships(a),c.addSelfRelationship(a,a.layerG,a),b&&(c.addDependantRelationship(b,a.layerG,a),c.addDependencyRelationship(a,b.layerG,b)),a.items&&a.items.length>0&&c.generateRelationships(a.items,a)})}}]),d}(j["default"].Diagram))({name:"layer",helpers:l["default"]})},a.exports=b["default"]},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(1),h=d(g),i={ids:0,Grid:function(){function a(b){e(this,a),this.position={x:0,y:0},this.width=b,this.cells=[]}return f(a,[{key:"addItemAtNewRow",value:function(a){var b=0;for(this.position.x=0;1e3>b&&(this.position.y+=1,!this.itemFitsAtCurrentPos(a)););this.addItemAtCurrentPos(a)}},{key:"addItemAtCurrentPos",value:function(a){this.addItemAtPos(a,this.position)}},{key:"createRowIfNecessary",value:function(a){_.isUndefined(this.cells[a])&&(this.cells[a]=[])}},{key:"addItemAtPos",value:function(a,b){var c=void 0;a.x=b.x,a.y=b.y;for(var d=0;d<a.height;d++){this.createRowIfNecessary(d+b.y),c=this.cells[d+b.y];for(var e=0;e<a.width;e++)c[e+b.x]=!0}this.updatePosition()}},{key:"updatePosition",value:function(){for(var a=0;1e3>a;){if(this.position.x+=1,this.position.x===this.width)this.position.x=-1,this.position.y+=1,this.createRowIfNecessary(this.position.y);else if(this.cells[this.position.y][this.position.x]!==!0)break;a++}}},{key:"itemFitsAtPos",value:function(a,b){for(var c=void 0,d=0;d<a.height;d++){if(c=this.cells[d+b.y],_.isUndefined(c))return!0;for(var e=0;e<a.width;e++){if(c[e+b.x]===!0)return!1;if(e+b.x+1>this.width)return!1}}return!0}},{key:"itemFitsAtCurrentPos",value:function(a){return this.itemFitsAtPos(a,this.position)}},{key:"movePositionToNextRow",value:function(){this.position.y++,this.position.x=0,this.createRowIfNecessary(this.position.y)}},{key:"lastRowIsEmpty",value:function(){for(var a=this.cells.length,b=0;b<this.width;b++)if(this.cells[a-1][b]===!0)return!1;return!0}},{key:"getSize",value:function(){var a=this.cells.length;return{width:this.width,height:this.lastRowIsEmpty()?a-1:a}}}]),a}(),config:{widthSize:350,heightSize:60,depthWidthFactor:4,depthHeightFactor:2,showNumbersAll:!1},handleConnectedToNextCaseIfNecessary:function(a,b){var c=a[b],d=a[b+1],e=void 0,f=void 0;c.hasOwnProperty("connectedWithNext")===!0&&d&&(d.id?f=d.id:(f="to-next-"+String(++i.ids),d.id=f),e=_.isObject(c.connectedWithNext)&&c.connectedWithNext.type?{id:f,type:c.connectedWithNext.type}:f,c.connectedTo?c.connectedTo.push(e):c.connectedTo=[e])},itemsOfLayerShouldBeSorted:function(a){var b=!0;return _.each(a,function(a){a.hasOwnProperty("connectedTo")&&(b=!1),a.hasOwnProperty("connectToNext")&&(b=!1)}),b},calculateLayerWithChildrenDimensions:function(a){var b=void 0,c=void 0,d=void 0,e=void 0,f=void 0,g=void 0,h=0,j=0,k=0,l=0,m=0,n=[],o=function(a){return b[a].inNewRow===!0?(c.addItemAtNewRow(b[a]),b.splice(a,1),!0):c.itemFitsAtCurrentPos(b[a])?(c.addItemAtCurrentPos(b[a]),b.splice(a,1),!0):!1};for(_.each(a.items,function(a){h+=a.width,j+=a.height,l=a.height>l?a.height:l,k=a.width>k?a.width:k,n.push(a)}),e=h/2>=k?j>h?j/2<a.items.length?Math.ceil(h/2):h:Math.ceil(h/2):k,e=i.maxUnityWidth<e?i.maxUnityWidth:e,c=new i.Grid(e),g=i.itemsOfLayerShouldBeSorted(n),b=g?n.sort(function(a,b){return a.width===b.width?a.height<b.height:a.width<b.width}):n,o(0),d=0;b.length>0&&1e3>m;)o(d)?d=0:g?(d++,d===b.length&&(d=0,c.movePositionToNextRow())):c.movePositionToNextRow(),m++;f=c.getSize(),a.x=0,a.y=0,a.width=f.width,a.height=a.items.length>0?f.height+1:f.height},generateLayersData:function(a,b){var c=i.config,d=void 0,e=void 0;return b=b||1,d=b,_.each(a,function(f,g){f.showNumbersAll===!0&&(c.showNumbersAll=!0),f.depth=b,i.handleConnectedToNextCaseIfNecessary(a,g),f.items.length>0?(e=i.generateLayersData(f.items,b+1),f.maxLayerDepthBelow=e-b,i.calculateLayerWithChildrenDimensions(f),d=e>d?e:d):(f.maxLayerDepthBelow=0,f.width=1,f.height=1,d=e>d?e:d),f.alreadyConnections=[]}),d},getFinalLayerDimensions:function(a){var b=i.config,c=a.height*b.heightSize-b.depthHeightFactor*a.depth*2,d=a.width*b.widthSize-b.depthWidthFactor*a.depth*2,e="translate("+b.depthWidthFactor*a.depth+","+(b.depthHeightFactor*a.depth+")"),f="url(#color-"+String(a.depth-1)+")",g={height:c,width:d,transform:e,fill:f};return(b.showNumbersAll===!0||a.containerData&&a.containerData.showNumbers===!0)&&(g.numberTransform="translate("+(String(d-15+b.depthWidthFactor*a.depth)+",")+(String(b.depthHeightFactor*a.depth+c+0)+")")),g},dataFromSpecificToGeneral:function(a){var b=-1,c=[],d=[],e=function f(a,e){_.each(a,function(a){var g=/(\. |:)/.exec(a.fullText),h=void 0,i=void 0,j=void 0,k=void 0;g&&(j=a.fullText.split(g[0]),h=j[0],i=j.slice(1).join(g)),k={name:h||a.fullText,description:i||null,graphsData:{layer:{relationships:a.options,id:a.id}},id:++b},c.push(k),e&&d.push({from:k.id,to:e.id}),a.items&&a.items.length>0&&f(a.items,k)})};return e([a]),{items:c,connections:d}},dataFromGeneralToSpecific:function(a){return h["default"].utils.dataFromGeneralToSpecificForATreeStructureType(a)},newLayer:function(a,b,c){var d={text:a};return _.isArray(b)?c=b:(_.isString(b)&&(b=i.extendOpts(b)),_.isObject(b)&&(d=_.extend(d,b))),c&&(d.items=c),_.isUndefined(d.id)&&(d.id="layer-"+ ++i.ids+"-auto"),d},newLayerConnectedToNext:function(){var a=arguments.length;return 1===a?i.newLayer(arguments[0],"cn"):2===a?"object"==typeof arguments[1]?i.newLayer(arguments[0],"cn",arguments[1]):i.newLayer(arguments[0],arguments[1]+" cn"):3===a?i.newLayer(arguments[0],arguments[1]+" cn",arguments[2]):void 0},staticOptsLetters:{co:{conditional:!0},cn:{connectedWithNext:!0},sna:{showNumbersAll:!0},sn:{showNumbers:!0},cnd:{connectedWithNext:{type:"dashed"}},nr:{inNewRow:!0}},idOpt:function(a){return{id:"layer-"+a+"-custom"}},extendOpts:function(){var a={};return _.each(arguments,function(b){"string"==typeof b?_.each(b.split(" "),function(b){"id-"===b.substr(0,3)?a=_.extend(a,i.idOpt(b.substr(3,b.length))):"ct-"===b.substr(0,3)?i.connectWithOpt(Number(b.substr(3,b.length)),a):"ctd-"===b.substr(0,4)?i.connectWithOpt(Number(b.substr(4,b.length)),a,"dashed"):a=_.extend(a,i.staticOptsLetters[b])}):_.isObject(b)&&(a=_.extend(a,b))}),a},connectWithOpt:function(a,b,c){var d=[];_.isNumber(a)&&(a=[a]),c=c||"standard",_.each(a,function(a){d.push({id:"layer-"+a+"-custom",type:c})}),_.isUndefined(b.connectedTo)===!0?b.connectedTo=d:b.connectedTo=b.connectedTo.concat(d)},connectWithOptAndIdOpt:function(a,b){var c=h["default"].layer.connectWithOpt(a),d=h["default"].layer.idOpt(b);return _.extend(c,d)}};_.each(["newLayer","newLayerConnectedToNext"],function(a){i[a+"WithCode"]=function(b){var c=h["default"].utils.codeBlockOfLanguageFn(b);return function(){var b=arguments;return b[0]=c(b[0]),i[a].apply(this,b)}},i[a+"WithParagraphAndCode"]=function(b){var c=h["default"].utils.codeBlockOfLanguageFn(b);return function(){var b=[].splice.call(arguments,0),d=b[0],e=b[1],f=h["default"].utils.wrapInParagraph(d)+c(e);return b=b.splice(2),b.unshift(f),i[a].apply(this,b)}}}),b["default"]=i,a.exports=b["default"]}]);